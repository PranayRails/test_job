<% path = @train_booking.new_record? ? train_bookings_path : train_booking_path(@train_booking) %>

<%= form_for(@train_booking, url: path, html: {:class => "form-horizontal center"}) do |f| %>
  <% if @train_booking.errors.any? %>
    <ul>
    <% @train_booking.errors.full_messages.each do |message| %>
      <li class="error-message"><%= message %></li>
    <% end %>
    </ul>
  <% end %>

  <div class="card container">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table">
            <tr>
              <th scope="col">Parcels count</th>
              <td><%= @parcel_ids&.count %></td>
            </tr>
            <tr>
              <th scope="col">Parcels Total weight</th>
              <td><%= Parcel.sum_weight(@parcel_ids) %></td>
            </tr>
            <tr>
              <th scope="col">Parcels Total Volume</th>
              <td><%= Parcel.sum_volume(@parcel_ids) %></td>
            </tr>
        </table>
      </div>
      <h2>Available Trains for selected parcels</h2>
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th scope="col"></th>
              <th scope="col">Weight Capacity</th>
              <th scope="col">Volume Capacity</th>
              <th scope="col">Source</th>
              <th scope="col">Destination</th>
              <th scope="col">Status</th>
              <th scope="col">Cost</th>
            </tr>
          </thead>
          <tbody>
            <% get_trains.each do |train| %>
              <tr>
                <td><%= f.radio_button :train_id, train.id, checked: false %></td>
                <td scope="row"><%= train.weight_capacity %> kg</td>
                <td><%= train.volume_capacity %>m3</td>
                <td><%= train.source %></td>
                <td><%= train.destination %></td>
                <td><%= train.status %></td>
                <td><%= train.cost %>/-</td>
              </tr>
              <% end %>
          </tbody>
        </table>
      </div>
      <%= f.hidden_field :parcels, value: @parcel_ids %>
      <%= f.submit 'submit', class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
